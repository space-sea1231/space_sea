struct Sparse_Table{
    int dp[N][Z], lg[N];
    Sparse_Table(){
        lg[0]=-1;
        for (int i=1; i<N; i++){
            lg[i]=lg[i>>1]+1;
        }
    }
    void init(){
        for (int j=1; j<=lg[n]; j++){
            for (int i=1; i+(1<<j)-1<=n; i++){
                dp[i][j]=max(dp[i][j-1], dp[i+(1<<(j-1))][j-1]);
            }
        }
    }
    int query(int l, int r){
        int len=lg[r-l+1];
        return max(dp[l][len], dp[r-(1<<len)+1][len]);
    }
};